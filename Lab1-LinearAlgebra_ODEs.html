
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Linear Algebra and Ordinary Differential Equations &#8212; Foundations of Neural and Cognitive Modelling</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Models of Single Spiking Neurons" href="Lab2-SingleNeurons.html" />
    <link rel="prev" title="Foundations of Neural and Cognitive Modelling" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Foundations of Neural and Cognitive Modelling</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Foundations of Neural and Cognitive Modelling
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lab assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Linear Algebra and Ordinary Differential Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab2-SingleNeurons.html">
   2. Models of Single Spiking Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab3-Hopfield.html">
   3. Hopfield Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab4-MLP.html">
   4. Multi-Layer Perceptron
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab5-RL.html">
   5. Reinforcement Learning
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://colab.research.google.com/github/clclab/FNCM/blob/main/book/Lab1-LinearAlgebra_ODEs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/clclab/FNCM"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/clclab/FNCM/issues/new?title=Issue%20on%20page%20%2FLab1-LinearAlgebra_ODEs.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Lab1-LinearAlgebra_ODEs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-algebra">
   1. Linear algebra
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectors-definitions">
     Vectors: definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-definitions">
     Matrices: definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-transformations">
     Vector transformations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determinant-and-trace">
     Determinant and trace
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvectors-and-eigenvalues">
     Eigenvectors and eigenvalues
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ordinary-differential-equations">
   2. Ordinary Differential Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-portraits-of-1-dimensional-odes">
     2.1. Phase portraits of 1-dimensional ODEs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-portraits-of-2-dimensional-odes">
     2.2. Phase portraits of 2-dimensional ODEs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-the-data">
     Generating the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-nullclines">
     Drawing nullclines
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-trajectories">
     Drawing trajectories
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>1. Linear Algebra and Ordinary Differential Equations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-algebra">
   1. Linear algebra
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectors-definitions">
     Vectors: definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-definitions">
     Matrices: definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-transformations">
     Vector transformations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determinant-and-trace">
     Determinant and trace
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvectors-and-eigenvalues">
     Eigenvectors and eigenvalues
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ordinary-differential-equations">
   2. Ordinary Differential Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-portraits-of-1-dimensional-odes">
     2.1. Phase portraits of 1-dimensional ODEs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-portraits-of-2-dimensional-odes">
     2.2. Phase portraits of 2-dimensional ODEs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-the-data">
     Generating the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-nullclines">
     Drawing nullclines
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-trajectories">
     Drawing trajectories
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="linear-algebra-and-ordinary-differential-equations">
<h1>1. Linear Algebra and Ordinary Differential Equations<a class="headerlink" href="#linear-algebra-and-ordinary-differential-equations" title="Permalink to this headline">#</a></h1>
<p>This notebook is part of a larger effort to offer an approachable introduction to models of the mind and the brain for the course “Foundations of Neural and Cognitive Modelling”, offered at the University of Amsterdam by <a class="reference external" href="https://staff.fnwi.uva.nl/w.zuidema/">Jelle (aka Willem) Zuidema</a>. The notebook in this present form is the result of the combined work of Iris Proff, <a class="reference external" href="http://mdhk.net/">Marianne de Heer Kloots</a>, and <a class="reference external" href="https://www.linkedin.com/in/simone-astarita-4499b11b5/">Simone Astarita</a>.</p>
<div class="section" id="instructions">
<h2>Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">#</a></h2>
<p>The following instructions apply if and only if you are a student taking the course “Foundations of Neural and Cognitive Modelling” at the University of Amsterdam (Semester 1, Period 2, Year 2022).</p>
<p>Submit your solutions on Canvas by Tuesday 8th November 18:00. Please hand in the following:</p>
<ul class="simple">
<li><p>A copy of this notebook with the <strong>code</strong> and results of running the code filled in the required sections. The sections to complete all start as follows:</p></li>
</ul>
<p><code>### YOUR CODE HERE ###</code></p>
<ul class="simple">
<li><p>A separate pdf file with the answers to the <strong>homework exercises</strong>. These can be identified by the following formatting, where <strong>n</strong> is the number of points (out of 10) that question <strong>m</strong> is worth:
<br></p></li>
</ul>
<blockquote>
<div><p><em><strong>Homework exercise m</strong></em>: question(s) <strong>(npt)</strong>.</p>
</div></blockquote>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>In this lab, we will use Python to study some essential concepts of linear algebra and then experiment with ordinary differential equations (ODEs) and phase portraits. In the first section, we will see the definitions, the notation, and the operations of vectors and matrices. We then explain determinants and eigenvalues of simple matrices, as these concepts will be used in the next weeks. If you already have a lot of experience with linear algebra in Python, you may simply skim or skip this section, but don’t forget to complete the homework exercise at the end of it.</p>
<p>In the second section, we will go step by step through a set of instructions to create a phase portrait for a 2-dimensional system of ODEs. Some of the code is given, but you will need to fill in some sections yourself.</p>
</div>
<div class="section" id="linear-algebra">
<h2>1. Linear algebra<a class="headerlink" href="#linear-algebra" title="Permalink to this headline">#</a></h2>
<div class="section" id="vectors-definitions">
<h3>Vectors: definitions<a class="headerlink" href="#vectors-definitions" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Vector space</strong>: a set closed under finite vector addition and scalar multiplication. Examples: <span class="math notranslate nohighlight">\(\mathbb{R}\)</span> (or <span class="math notranslate nohighlight">\(\mathbb{R}^1\)</span>), the set of real numbers; <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, the set of bidimensional vectors; <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, the set of tridimensional vectors.</p></li>
<li><p><strong>Vector</strong>: formally, vectors are members of a vector space, so they can be added together and multiplied by a scalar, while remaining in the same vector space. Visually, think of an arrow (= a line with a direction) situated in the space. In practice, when we use them they look like this: <span class="math notranslate nohighlight">\(v = [v_1, v_2, ..., v_{n-1}, v_n]\)</span>. In <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, <span class="math notranslate nohighlight">\(v_1, v_2, ..., v_{n-1}, v_n\)</span> are the coordinates of the vector.</p></li>
<li><p><strong>Scalar</strong>: a ‘scalar’ is the mathematical term for a single number, like 2, 6.7 or 14,000,000.</p></li>
<li><p><strong>Dimensionality</strong>: number of elements in a vector. It may sometimes be referred to as <em>length</em>, especially in programming languages: for example, <code>len([1,2,5,0])</code> returns <code>4</code>, the dimensionality of the vector, in Python.</p></li>
<li><p><strong>Length</strong> or <strong>Euclidean norm</strong>: the actual length of a vector. It is computed as follows: <span class="math notranslate nohighlight">\(|\vec{v}| = \sqrt{v_1^2 + \ldots + v_n^2}\)</span>.</p></li>
<li><p><strong>Scaling</strong>: modifying (= multiplying) the length of a vector <span class="math notranslate nohighlight">\(v\)</span> by a scalar value <span class="math notranslate nohighlight">\(a\)</span>: <span class="math notranslate nohighlight">\(a \times \vec{v} = \vec{u}\)</span> with <span class="math notranslate nohighlight">\(u_i = a \times v_i\)</span>.</p></li>
<li><p><strong>Vector addition</strong>: adding together vectors of the same dimensionality (= that belong to the same vector space): <span class="math notranslate nohighlight">\(\vec{v} + \vec{w} = \vec{w} + \vec{v} = \vec{u}\)</span> with <span class="math notranslate nohighlight">\(u_i = v_i + w_i\)</span>.</p></li>
<li><p><strong>Vector multiplication or dot product</strong>: multiplying together vectors of the same dimensionality, which results in a scalar: <span class="math notranslate nohighlight">\(\vec{v} \times \vec{w} = \vec{w} \times \vec{v} = a\)</span>, with <span class="math notranslate nohighlight">\(a = \sum v_i \times w_i\)</span>. In Python, we use the command <code>dot(v,w)</code> or <code>v &#64; w</code>.</p></li>
<li><p><strong>Linear dependence</strong>: two vectors <span class="math notranslate nohighlight">\(\vec{v}\)</span> and <span class="math notranslate nohighlight">\(\vec{w}\)</span> are linearly dependent if and only if <span class="math notranslate nohighlight">\(\vec{v}=a\vec{w}\)</span> for some scalar <span class="math notranslate nohighlight">\(a\)</span>.</p></li>
</ul>
<p>In order to deal with vectors and matrices in Python, we use the <em>numpy</em> package. When writing <code>import numpy as np</code> in the beginning of our script, we can access all numpy functions using the shortcut <code>np</code>.</p>
<p>The following cell contains some commands to create vectors and matrices. Figure out how the functions work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># package for basic algebra</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#  creating basic row and column vectors and matrices</span>
<span class="n">v1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">v2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>

<span class="c1"># other ways to make vectors and matrices</span>
<span class="n">v3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>       
<span class="n">v4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>   
<span class="n">v5</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>  
<span class="n">v6</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">v7</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">m2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="c1"># check the values the different variables get by running the code above and changing v1 into v2, v3 etc in this cell, and running it..</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrices-definitions">
<h3>Matrices: definitions<a class="headerlink" href="#matrices-definitions" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Matrix</strong>: a 2D array of numbers, so it has one or more columns and one or more rows (A vector is a matrix with either only one column or only one row; note that in Python, by default, there is no difference between row and column vectors).</p></li>
<li><p><strong>Size</strong>: the <strong>height</strong> (= number of rows) times the <strong>width</strong> (= number of columns) of a matrix.</p></li>
<li><p><strong>Scaling</strong>: modifying (= multiplying) each number in a matrix <span class="math notranslate nohighlight">\(A\)</span> by a scalar value <span class="math notranslate nohighlight">\(c\)</span>: <span class="math notranslate nohighlight">\(c \times A = B\)</span>, with <span class="math notranslate nohighlight">\(B_{i,j} = c \times A_{i,j}\)</span>.</p></li>
<li><p><strong>Addition</strong>: adding each number of two matrices together <span class="math notranslate nohighlight">\(A + B = B + A = C\)</span>, with <span class="math notranslate nohighlight">\(c_{i,j} = a_{i.j} + b_{i,j}\)</span>, only if A and B same sizes.</p></li>
<li><p><strong>Multiplication:</strong> you can multiply two matrices to obtain a single matrix. In particular, <span class="math notranslate nohighlight">\(A \times B = C\)</span>, with <span class="math notranslate nohighlight">\(c_{ij} = \sum_{k=1}^pa_{ik}b_{kj}\)</span>, only if the number columns in <span class="math notranslate nohighlight">\(A\)</span> is the same as the number of rows in <span class="math notranslate nohighlight">\(B\)</span> (and said number is <span class="math notranslate nohighlight">\(p\)</span>).</p></li>
</ul>
<p>Example:</p>
<p><span class="math notranslate nohighlight">\(\begin{pmatrix}-1 &amp; 2\\ 4 &amp; 1 \end{pmatrix}
\times
\begin{pmatrix}4 &amp; 1\\ 3 &amp; 5 \end{pmatrix}
= \begin{pmatrix} -1 \cdot 4+2 \cdot 3 &amp; -1 \cdot 1+2 \cdot 5 \\ 4 \cdot 4 + 1 \cdot 3 &amp; 4 \cdot 1 + 1 \cdot 5 \end{pmatrix}
= \begin{pmatrix}2 &amp; 9\\ 19 &amp; 9 \end{pmatrix}\)</span></p>
<p>In Python, use <code>np.dot(A,B)</code> or <code>A&#64;B</code> to compute the matrix product of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
<br>
<blockquote>
<div><ul class="simple">
<li><p>Use Python to create two matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> with <span class="math notranslate nohighlight">\(A \ne B\)</span> and that satisfy the conditions for <strong>multiplication</strong>. Compute <span class="math notranslate nohighlight">\(A \times B\)</span> and <span class="math notranslate nohighlight">\(B \times A\)</span>: is the result the same? Briefly explain the result in a comment in the code.</p></li>
<li><p>Play around to understand the difference between <code>np.dot(v1,v2)</code> and <code>v1*v2</code>, where <code>v1</code> and <code>v2</code> are vectors or matrices.</p></li>
<li><p>Type <code>B.shape</code> and <code>B.size</code>. What information do the commands provide?</p></li>
</ul>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE ###</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vector-transformations">
<h3>Vector transformations<a class="headerlink" href="#vector-transformations" title="Permalink to this headline">#</a></h3>
<p>Multiplying a vector with a square matrix transforms the vector:  <span class="math notranslate nohighlight">\(A * \vec{v} = \vec{w}\)</span>. Usually the new vector has a new direction or length, or both.</p>
<p>Create a 2x2 square matrix and apply it to different vectors to see what linear transformations it defines. Plot your results to get a better understanding.</p>
<p>You can define a special matrix <span class="math notranslate nohighlight">\(A\)</span> – called the rotation matrix – that only rotates (and does not scale) a vector as follows. After applying this matrix to a vector, the new vector has the same length but a different direction. <span class="math notranslate nohighlight">\(\Phi\)</span>  defines the angle of the rotation, where <span class="math notranslate nohighlight">\(360^{\circ}\)</span> corresponds to <span class="math notranslate nohighlight">\(\Phi = 2\pi\)</span>.</p>
<p><span class="math notranslate nohighlight">\( A\vec{v} = \)</span><span class="math notranslate nohighlight">\(\begin{pmatrix} cos\phi&amp;-sin\phi \\\ sin\phi&amp;cos\phi\end{pmatrix}\)</span><span class="math notranslate nohighlight">\(\left(\begin{array}{c}v_x \\ v_y\end{array}\right) = \)</span><span class="math notranslate nohighlight">\(
\begin{pmatrix} v_xcos\phi - v_ysin\phi \\\ v_xsin\phi + v_ycos\phi \end{pmatrix}\)</span></p>
<br>
<p>In the following, we draw the vector <span class="math notranslate nohighlight">\(\vec{v} = \begin{pmatrix}0.5 \\0.5\end{pmatrix}\)</span>. We then create a matrix that rotates a vector by 45 degrees (the code applies it to the vector <span class="math notranslate nohighlight">\(\vec{v}\)</span>, and draws the resulting vector in red in the same figure) . Note: the code uses <code>math.pi</code> for <span class="math notranslate nohighlight">\(\pi\)</span>; to divide real numbers e.g. <span class="math notranslate nohighlight">\(5\)</span> and <span class="math notranslate nohighlight">\(2\)</span>, we use the following notation: <code>5./2.</code>.</p>
<blockquote>
<div><p>Try rotating the vector by 90, 180, 270 and 360 degrees by changing the value of <code>phi</code>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># package for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">head_width</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1">### YOUR CODE HERE ###</span>
<span class="c1"># change the value of phi</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)],[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)]])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">head_width</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># set the axis to the -1,1 range, and plot in a nice square</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="determinant-and-trace">
<h3>Determinant and trace<a class="headerlink" href="#determinant-and-trace" title="Permalink to this headline">#</a></h3>
<p>Two interesting values of a square matrix are the <em>determinant</em> and the <em>trace</em>. The determinant of a <span class="math notranslate nohighlight">\(2\times2\)</span> matrix is computed as follows:</p>
<p><span class="math notranslate nohighlight">\(A = \left( \begin{array}{cc}    a     &amp; b \\    c     &amp; d    \end{array} \right), 
\quad \det(A)=\left| \begin{array}{cc}  a &amp; b \\c&amp; d \end{array} \right| = ad - cb\)</span></p>
<p>The <em>trace</em> of a matrix is the sum of the main diagonal, which is the one from upper left to lower right. So, in a <span class="math notranslate nohighlight">\(2\times2\)</span> matrix:</p>
<p><span class="math notranslate nohighlight">\(A = \left( \begin{array}{cc}    a     &amp; b \\    c     &amp; d    \end{array} \right), 
\quad \text{tr}(A)=\left| \begin{array}{cc}  a &amp; b \\c&amp; d \end{array} \right| = a+d\)</span></p>
</div>
<div class="section" id="eigenvectors-and-eigenvalues">
<h3>Eigenvectors and eigenvalues<a class="headerlink" href="#eigenvectors-and-eigenvalues" title="Permalink to this headline">#</a></h3>
<p>When a matrix <span class="math notranslate nohighlight">\(M\)</span> is multiplied with a vector, this yields a new vector, as explained above. For most vectors, both the length and the direction changes. Some vectors however do not get not rotated by mutliplication with <span class="math notranslate nohighlight">\(M\)</span> or any other square matrix. For these vectors, it holds that <span class="math notranslate nohighlight">\(M\times \vec{v} = \lambda\vec{v}\)</span>. In other words, the vectors get only scaled by the matrix. These are so-called eigenvectors. The corresponding scaling factor <span class="math notranslate nohighlight">\(\lambda\)</span> is called the eigenvalue.</p>
<p>Let’s now see how we can compute eigenvectors and eigenvalues of a  <span class="math notranslate nohighlight">\(2\times2\)</span> matrix.</p>
<p><span class="math notranslate nohighlight">\(M \vec{v} = \lambda \vec{v}\)</span> can be rewritten as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array} \right)\left( \begin{array}{cc} v_x \\ v_y  \end{array} \right) &amp;= \lambda \left( \begin{array}{cc} v_x \\ v_y  \end{array} \right)\\
\left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array} \right)\left( \begin{array}{cc} v_x \\ v_y  \end{array} \right) -\lambda \left( \begin{array}{cc} v_x \\ v_y  \end{array} \right) &amp;= \left( \begin{array}{cc} 0 \\ 0  \end{array} \right)\\
\left( \begin{array}{cc} a-\lambda &amp; b \\ c &amp; d-\lambda \end{array} \right)\left( \begin{array}{cc} v_x \\ v_y  \end{array} \right)  &amp;= \left( \begin{array}{cc} 0 \\ 0  \end{array} \right)\\
\end{align*}
\end{split}\]</div>
<p>From this, we can derive the so-called <em>characteristic equation</em>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
(a-\lambda)(d-\lambda)-bc&amp;=0 \\
\lambda^2 - (a+d)\lambda + ad -bc&amp;=0 \\
\end{align*}
\end{split}\]</div>
<p>This equation can be solved to obtain the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{1,2}\)</span>. The corresponding eigenvectors <span class="math notranslate nohighlight">\(v\)</span> can be obtained by solving the following equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left( \begin{array}{cc} a-\lambda &amp; b \\ c &amp; d-\lambda \end{array} \right)\left( \begin{array}{cc} v_x \\ v_y  \end{array} \right)  &amp;= \left( \begin{array}{cc} 0 \\ 0  \end{array} \right)\\
\end{align*}
\end{split}\]</div>
<p>This yields <span class="math notranslate nohighlight">\(v_{1,2}=\begin{pmatrix}-b\\a-\lambda_{1,2}\end{pmatrix}\)</span> as eigenvectors for the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{1,2}\)</span>, respectively.</p>
<p>If <span class="math notranslate nohighlight">\(\vec{v}\)</span> is an eigenvector of a matrix <span class="math notranslate nohighlight">\(M\)</span>, then for an arbitrary number <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(k \vec{v}\)</span> is also an eigenvector, with the same eigenvalue. In other words, eigenvectors are not unique.  An <span class="math notranslate nohighlight">\(n\times n\)</span> square matrix has a maximum of <span class="math notranslate nohighlight">\(n\)</span> eigenvalues, and equally many <em>linearly independent</em> eigenvectors. Two vectors are linarly independent if they are not scaled versions of each other.</p>
<br>
<blockquote>
<div><p>Consider a matrix <span class="math notranslate nohighlight">\(M=\begin{pmatrix}1&amp;2\\2&amp;1\end{pmatrix}\)</span>: we can use the  Python function <code>np.linalg.eig()</code> to compute eigenvalues and eigenvectors of the matrix <span class="math notranslate nohighlight">\(M\)</span> (see cell below). Try to find matrices that have negative and/or complex eigenvalues using the code.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE ###</span>

<span class="c1"># try to find matrices with negative and/or complex eigenvalues by changing the values of M</span>

<span class="c1"># the matrix</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1"># np.linalg.eig() creates a tuple of two arrays containing eigenvalues and eigenvectors</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="c1"># print eigenvalues and eigenvectors</span>
<span class="c1"># note: the COLUMNS of &quot;eigenvectors&quot; are the eigenvectors</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">)</span>

<span class="c1"># see the first eigenvalues and corresponding eigenvector</span>
<span class="n">eigenvalue1</span> <span class="o">=</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">eigenvector1</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">eigenvalue2</span> <span class="o">=</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">eigenvector2</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eigenvalue1</span><span class="p">,</span> <span class="n">eigenvector1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenvalue2</span><span class="p">,</span> <span class="n">eigenvector2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Check the eigenvector/eigenvalue condition for both eigenvalues and eigenvectors. Remember: <span class="math notranslate nohighlight">\(\vec{v}\)</span> is an eigenvector of a matrix <span class="math notranslate nohighlight">\(M\)</span> if:</p>
<div class="math notranslate nohighlight">
\[ M \vec{v} = \lambda \vec{v} \]</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE ###</span>

<span class="c1"># pick the eigenvalues and eigenvectors from the cell above</span>
<span class="c1"># then do the relevant multiplications</span>

<span class="c1">####</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><em><strong>Homework exercise 1</strong></em>: What are the determinant, trace, eigenvalues and corresponding eigenvectors of matrix <span class="math notranslate nohighlight">\(M=\begin{pmatrix}5&amp;2\\4&amp;3\end{pmatrix}\)</span>? You have to first calculate all 4 of them yourself, then use the code to check that the eigenvalues and eigenvectors are correct. <strong>(1.5pt)</strong></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE</span>

<span class="c1"># define M</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="c1"># copy-paste the code from above to calculate eigenvalues and their respective eigenvectors</span>

<span class="c1">####</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<hr class="docutils" />
</div>
</div>
<hr class="docutils" />
<div class="section" id="ordinary-differential-equations">
<h2>2. Ordinary Differential Equations<a class="headerlink" href="#ordinary-differential-equations" title="Permalink to this headline">#</a></h2>
<div class="section" id="phase-portraits-of-1-dimensional-odes">
<h3>2.1. Phase portraits of 1-dimensional ODEs<a class="headerlink" href="#phase-portraits-of-1-dimensional-odes" title="Permalink to this headline">#</a></h3>
<p>A phase portrait is a visual representation of the trajectories of a dynamical system.</p>
<p>Let’s first consider a 1-dimensional ODE:</p>
<center>
    \begin{equation}
        \frac{dx}{dt}=2-0.1*x
    \end{equation}
</center>
<blockquote>
<div><p><em><strong>Homework exercise 2:</strong></em> Let’s assume that the variable <span class="math notranslate nohighlight">\(x\)</span> denotes the speed of an object. What information does the equation above provide? <strong>(0.5pt)</strong></p>
</div></blockquote>
<p>The code below plots a one-dimensional vector field for our ODE. That means, at a range of <span class="math notranslate nohighlight">\(x\)</span> values, it draws an arrow pointing into the direction of the derivative <span class="math notranslate nohighlight">\(dx\)</span>. Moreover, it also plots the derivative <span class="math notranslate nohighlight">\(\frac{dx}{dt} = 2-0.1*x\)</span> and the corresponding function, <span class="math notranslate nohighlight">\(f(x) = 2x - \frac{x^2}{20}\)</span> (assuming the constant <span class="math notranslate nohighlight">\(c = 0\)</span>). To plot vectors field, we use the <code>quiver</code> function from the <code>matplotlib.pyplot</code> library.</p>
<p>Note that, for visual reasons, we rather define the values for the <span class="math notranslate nohighlight">\(\frac{dx}{dt}\)</span> and for the vector field differently, as too many arrows make it hard to understand which direction the vectors are going, but the ODE is still the same. If this does not make sense to you, try to chance <code>x_vecs</code> below with the code that defines <code>x</code>: what happens? Similarly, play around with the values of <code>plt.xlim</code> and <code>plt.ylim</code> to get a good picture of both <span class="math notranslate nohighlight">\(\frac{dx}{dt}\)</span> and <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># package to solve ODEs</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">odeint</span>

<span class="c1"># define values to be evaluated for the ODE</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># define ODE</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span>

<span class="c1"># define values to be evaluated for the vector field</span>
<span class="n">x_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vecs</span><span class="p">))</span>

<span class="c1"># define ODE for the vector field</span>
<span class="n">dx_vecs</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x_vecs</span>

<span class="c1"># plot vector field</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x_vecs</span><span class="p">,</span> <span class="n">y_vecs</span><span class="p">,</span> <span class="n">dx_vecs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span>  <span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>  <span class="n">headwidth</span><span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># plot the derivative</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span>

<span class="c1"># plot the function f(x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">20</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>

<span class="c1"># the limits of the graphs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lab1-LinearAlgebra_ODEs_16_0.png" src="_images/Lab1-LinearAlgebra_ODEs_16_0.png" />
</div>
</div>
<p>In a similar way, create a phase portrait of:</p>
<center>
    \begin{equation}
        \frac{dx}{dt} = sin(x)
    \end{equation}
</center>
<blockquote>
<div><p>Write your code in the following cell; some obvious parts are already in there for you. Remember to also include the integral of <span class="math notranslate nohighlight">\(sin(x)\)</span>, that is the function <span class="math notranslate nohighlight">\(f(x)\)</span> from which the funciton is taken from: it helps you check that your vector field actually makes sense.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE ###</span>

<span class="c1">### SOLUTION ###</span>

<span class="c1"># define values to be evaluated</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">x_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vecs</span><span class="p">))</span>

<span class="c1"># define ODE</span>
<span class="n">dx_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_vecs</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c1"># plot vector field</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x_vecs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx_vecs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">headwidth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lab1-LinearAlgebra_ODEs_18_0.png" src="_images/Lab1-LinearAlgebra_ODEs_18_0.png" />
</div>
</div>
</div>
<div class="section" id="phase-portraits-of-2-dimensional-odes">
<h3>2.2. Phase portraits of 2-dimensional ODEs<a class="headerlink" href="#phase-portraits-of-2-dimensional-odes" title="Permalink to this headline">#</a></h3>
<p>Now let’s consider the 2-dimensional case. We work with a system of two linear first-order ODEs, defined by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left\{ \begin{array}{c}
\frac{dx}{dt} = a x + b y \\
\frac{dy}{dt} = c x + d y
\end{array} \right.
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are independent variables and <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(d\)</span> are parameters.</p>
<p>Whether this system has a stable equilibrium depends on the value of the parameters. By investigating the phase portrait, we examine how the behavior of the system changes with its parameter values.</p>
</div>
<div class="section" id="generating-the-data">
<h3>Generating the data<a class="headerlink" href="#generating-the-data" title="Permalink to this headline">#</a></h3>
<p>To create a phase portrait, we first generate a grid of points <span class="math notranslate nohighlight">\((x, y)\)</span> at which we want to compute <span class="math notranslate nohighlight">\(dx\)</span> and <span class="math notranslate nohighlight">\(dy\)</span>. We do this by creating a vector with <span class="math notranslate nohighlight">\(x\)</span>-values and a vector with <span class="math notranslate nohighlight">\(y\)</span>−values (decide for yourself if you like the current ranges for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> values). We then create two arrays that together contain all combinations of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> using the <code>np.meshgrid</code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### GENERATE DATA ###</span>

<span class="c1"># make a grid of x and y values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We want to compute <span class="math notranslate nohighlight">\(dx\)</span> and <span class="math notranslate nohighlight">\(dy\)</span> at all points (<code>x_vals[i,j]</code>, <code>y_vals[i,j]</code>): we write a
function to easily compute these two components.</p>
<blockquote>
<div><p>Create a function called <code>dxdy</code> that takes an <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> value as input, and a vector containing the parameters <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(d\)</span> and returns a vector containing <span class="math notranslate nohighlight">\(dx\)</span> and <span class="math notranslate nohighlight">\(dy\)</span>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### this is the definition of our 2-dimensional ODE</span>
<span class="k">def</span> <span class="nf">dxdy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="c1">### YOUR CODE HERE</span>
    <span class="c1"># remember: param = (a,b,c,d)</span>
    <span class="n">dx</span> <span class="o">=</span>
    <span class="n">dy</span> <span class="o">=</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then use the function to compute the derivative at all previously defined
points in the state space using a loop. We store these components in two arrays
called <code>x_dirs</code> and <code>y_dirs</code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># COMPUTE ODE values</span>

<span class="c1"># example values</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="c1"># set parameters for the ODE</span>
<span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># evaluate ODE at all points in our grid</span>
<span class="n">x_dirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)))</span>
<span class="n">y_dirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)):</span>
        <span class="nb">dir</span> <span class="o">=</span> <span class="n">dxdy</span><span class="p">(</span><span class="n">x_vals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">y_vals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">x_dirs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_dirs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have generated the data we needed, we can generate a vector field. Vary the parameters <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(d\)</span> in the cell above to see if you can get qualitatively different types of phase portraits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### PLOT VECTOR FIELD ###</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_dirs</span><span class="p">,</span> <span class="n">y_dirs</span><span class="p">)</span> <span class="c1">#X: xlocations Y: ylocations U: xdirections V: ydirections</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
</div>
<p>You can also play with it: draw vector fields for the dynamical systems defined by some parameter matrices, and try and see what type of equilibrium do they yield.</p>
</div>
<div class="section" id="drawing-nullclines">
<h3>Drawing nullclines<a class="headerlink" href="#drawing-nullclines" title="Permalink to this headline">#</a></h3>
<p>To get a more complete phase portrait, we also want to include the nullclines in the plot.
The <span class="math notranslate nohighlight">\(x\)</span>-nullcline is the set of points where <span class="math notranslate nohighlight">\(\frac{dx}{dt}= 0\)</span>, the <span class="math notranslate nohighlight">\(y\)</span>-nullcline is the set of points where
<span class="math notranslate nohighlight">\(\frac{dy}{dt}= 0\)</span>. The general definition of nullcline is a little more involved, but these work for our (2-dimensional) purposes.</p>
<blockquote>
<div><p><em><strong>Homework exercise 3</strong></em>: Analytically (with pen &amp; paper!) determine the two nullclines by finding the solutions to <span class="math notranslate nohighlight">\(\frac{dx}{dt}= 0\)</span> and <span class="math notranslate nohighlight">\(\frac{dy}{dt}= 0\)</span> as a function of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(d\)</span> (and <span class="math notranslate nohighlight">\(x\)</span>). Both your solutions should be of the form <span class="math notranslate nohighlight">\(y = f(x, a, b, c, d)\)</span> i.e. you must not have numbers in place of constants and variables. Specify what assumptions, if any, you make about the them in order to provide your solution. <strong>(1.5pt)</strong> Show analytically (i.e. using the equations you just found) that <span class="math notranslate nohighlight">\((0, 0)\)</span> is always an equilibrium. <strong>(0.5pt)</strong></p>
</div></blockquote>
<p>We now create a function <span class="math notranslate nohighlight">\(x\)</span>-nullcline and a function <span class="math notranslate nohighlight">\(y\)</span>-nullcline that return the <span class="math notranslate nohighlight">\(y\)</span>-values for the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-nullclines as a function of <span class="math notranslate nohighlight">\(x\)</span> and a vector containing the parameters <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(d\)</span>. Use these functions to plot the <span class="math notranslate nohighlight">\(x\)</span> and the <span class="math notranslate nohighlight">\(y\)</span> nullcline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### NULLCLINES ###</span>

<span class="c1"># definition of the x and y nullcline</span>
<span class="k">def</span> <span class="nf">x_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">y_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># plot nullclines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="drawing-trajectories">
<h3>Drawing trajectories<a class="headerlink" href="#drawing-trajectories" title="Permalink to this headline">#</a></h3>
<p>To draw trajectories through the statespace, we use the function <code>odeint</code> from the <code>scipy.integrate</code> package. The function <code>odeint</code> takes the following inputs: the state vector (containing the values <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>), the times at which output is required (<span class="math notranslate nohighlight">\(t\)</span>), the function that returns the rate of change (<span class="math notranslate nohighlight">\(\frac{dx}{dy}\)</span>), and the parameter vector (<span class="math notranslate nohighlight">\(param\)</span>).</p>
<p>The odeint function requires a specific format for the description of the system; you can use the following function, which uses the function <code>dxdy</code> you wrote yourself before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the definition of our 2-dimensional ODE</span>

<span class="k">def</span> <span class="nf">ode_system</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">state</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">state</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Here we us the dxdy function</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dxdy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">param</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can now use the odeint function to compute a trajectory starting from <code>x_init</code> and <code>y_init</code>. In the top of the following cell, copy the pieces of code you wrote above to make the vector field and to plot the nullclines to create a full phase portrait.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot vectorfield</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_dirs</span><span class="p">,</span> <span class="n">y_dirs</span><span class="p">)</span>

<span class="c1"># plot nullclines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_nullcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="c1">###</span>

<span class="c1">### TRAJECTORIES ###</span>
<span class="c1"># make grid of initial values for trajectories</span>
<span class="n">x_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_init</span><span class="p">,</span> <span class="n">y_init</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span><span class="n">y_grid</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="c1"># time points to evaluate</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># compute trajectories for each point on grid</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_init</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_init</span><span class="p">)):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_init</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">ode_system</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">param</span><span class="p">,))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trajectory</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">trajectory</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>From the ODEs given above, we can extract the parameter matrix <span class="math notranslate nohighlight">\(M = \left( \begin{array}{cc}    a     &amp; b \\    c     &amp; d    \end{array} \right)\)</span>.</p>
<p>The properties of this matrix can inform us about the behavior of the system. This is because we can view the current position in state space as a vector <span class="math notranslate nohighlight">\(\left( \begin{array}{c} x \\ y \end{array} \right)\)</span>, and one step of the dynamics defined by our dynamical system as multiplying with <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The following table summarizes the relationship between equilibrium types and the properties of their matrices:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Equilibrium type</p></th>
<th class="text-align:left head"><p>Eigenvalues</p></th>
<th class="text-align:left head"><p>Determinant and Trace</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>(1) Saddle point</p></td>
<td class="text-align:left"><p>Real, opposite sign</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{Det} &lt; 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>(2) Stable node</p></td>
<td class="text-align:left"><p>Real, negative</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(0 &lt; \text{Det} &lt; \frac{\text{Tr}^2}{4}\)</span> <br> <span class="math notranslate nohighlight">\(\text{Tr} &lt; 0\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>(3) Unstable node</p></td>
<td class="text-align:left"><p>Real, positive</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(0 &lt; \text{Det} &lt; \frac{\text{Tr}^2}{4}\)</span> <br> <span class="math notranslate nohighlight">\(\text{Tr} &gt; 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>(4) Stable spiral</p></td>
<td class="text-align:left"><p>Complex, negative real part</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(0 &lt; \frac{\text{Tr}^2}{4} &lt; \text{Det}\)</span> <br> <span class="math notranslate nohighlight">\(\text{Tr} &lt; 0\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>(5) Unstable spiral</p></td>
<td class="text-align:left"><p>Complex, positive real part</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(0 &lt; \frac{\text{Tr}^2}{4} &lt; \text{Det}\)</span> <br> <span class="math notranslate nohighlight">\(\text{Tr} &gt; 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>(6) Center point</p></td>
<td class="text-align:left"><p>Complex, zero real part</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\text{Det} &gt; 0\)</span> <br> <span class="math notranslate nohighlight">\(\text{Tr} = 0\)</span></p></td>
</tr>
</tbody>
</table>
<p>Here you can see the graphical representations of the equilibria:</p>
<p><img alt="image" src="https://raw.githubusercontent.com/clclab/FNCM/main/book/Lab1-dettr.png" /></p>
<p>Finally, you can see the interaction between equilibria shape and eigenvalues, determinant, and trace in <a class="reference external" href="https://www.youtube.com/watch?v=48BMz9db71E&amp;list=PL8erL0pXF3JYiEz1b8eLPq49aDeMBF99C&amp;index=50">this YouTube video</a> or at <a class="reference external" href="http://www.math.stonybrook.edu/~scott/mat308.spr11/demovie.html">this page</a>.</p>
<blockquote>
<div><p><em><strong>Homework exercise 4:</strong></em> Find parameters for which the system has all six types of equilibria. For each of them, hand in the corresponding phase portait plots, report the corresponding matrix and its eigenvalues and eigenvectors, using the function <code>np.linalg.eig()</code>. Briefly show that you results are consistent with what is mentioned in the table above. <strong>(6pt)</strong>
<br></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### YOUR CODE HERE ###</span>

<span class="c1"># copy-paste the code from above, just change the values of parameters in param</span>

<span class="c1">###</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Foundations of Neural and Cognitive Modelling</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Lab2-SingleNeurons.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2. Models of Single Spiking Neurons</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    <div class="extra_footer">
      <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>